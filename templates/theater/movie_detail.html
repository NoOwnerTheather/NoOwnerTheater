{% extends 'base.html' %}

{% block content %}

<div class="section">

    <!-- <div class="floating">
        <div class="rating d-flex flex-column py-3" style="height: 10rem;">
            <h3 class="text-start">{{ movie.rating }}</h3>
            <hr class="diagonal">
            <h3 class="text-start">5.0</h3>
        </div>
        <div class="d-flex flex-column">
            <a class="badge rounded-pill bg-dark text-light py-2" href="{% if movie.video %} {{movie.video.url}} {% endif %}">예고편</a>
            <a class="badge rounded-pill bg-dark text-light py-2" href="{% url 'theater:review_enroll' pk=movie.id%}">리뷰 작성</a>
        </div>    
    </div> -->
    



    <div class="container">
        <div class="row">
            <div class="col">
                <div class="card" style="width: 100%">

                <div class="jb-wrap">
                    <div class="text-center jb-image">
                        <img class="img-fluid" src="{{movie.poster.url}}"  alt="...">
                    </div>
                </div>

                    <div class="card-body">
                        <div>
                            <h5 class="text-start">Synopsis</h5>
                            <hr class="movie_detail_hr">
                            <div class="text-center">
                                <h2 class="movie_title my-5">{{ movie.title }}</h2>
                            </div>
                            <div class="card my-3 text-center" style="width: 100%">
                                <div class="card-body m-2">
                                    <p>감독 | {{ movie.director }}</p>
                                    <p>장르 | {{ movie.genre }}</p>
                                    <p>출연 | {{ movie.actor }}</p>
                                    <p>개봉 | {{ movie.release_date }}</p>
                                </div>
                            </div>
                            <p class="text-center py-5 mx-5 px-5" id="movie_content">{% autoescape on %}{{movie.content|safe}}{% endautoescape %}</p>
                            <h5 class="text-start">Review</h5>
                            <hr class="movie_detail_hr">
                                    {% for review in reviews %}
                                    <div class="col-md-3 mb-3" style="width: 100%">
                                        <div class="card text-center" style="width: 100%">
                                            <a href="{% url 'theater:review_detail' pk=review.id%}">
                                            <h3 class="review_title text-center mt-3">{{review.title}}</h3>
                                            <div class="card-body">
                                              <span class="stars text-dark me-2 d-flex justify-content-center">{{review.rating}}</span>
                                              <p class="mt-3">{{review.user}}</p>
                                              <div class="d-flex justify-content-end px-2">
                                                  <p>{{review.like}}</p>
                                              </div>
                                            </div>
                                        </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                        </div>
                    </div>

                    <div class="text-center my-5 pt-3">
                        <a onClick="history.go(-1)"">
                            <button type="button" class="btn btn-dark my-5 text-center">목록</button>
                        </a>
                    </div>

                </div>     
            </div>    
        </div>  
    </div>      
</div>



<script>
const rating = document.querySelectorAll(".stars");
rating.forEach((value) => {
  let ratingStars = "";
  for (let i = 0; i < Math.floor(value.innerText); i++) {
    ratingStars += '<i class="fas fa-star"></i>';
  }
  if (value.innerText % 1) {
    ratingStars += '<i class="fas fa-star-half"></i>';
  }
  value.innerHTML = ratingStars;
});

</script>





{% endblock %}