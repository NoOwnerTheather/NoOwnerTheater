{% extends 'base.html' %}

{% block content %}

<style>
    .jb-wrap {
        /* width: 40%; */
        margin: 10px auto;
        border: 1px solid #000000;
        position: relative;
    }
    .jb-wrap img {
        width: 100%;
        vertical-align: middle;
    }
    .jb-text {
        padding: 5px 10px;
        /* background-color: yellow; */
        /* text-align: center; */
        position: absolute;
	    top: 90%;
	    /* left: 10%; */
        color: white;
    }
    .title_text {
        padding: 5px 10px;
        /* background-color: yellow; */
        /* text-align: center; */
        position: absolute;
	    bottom: 2%;
	    right: 0%;
        color: white;
        font-weight: bold;
        font-size:xx-large;
    }

    .text-start {
        font-weight: bold;
        font-size:xx-large;
    }

    .review_title {
        font-weight: 550;
    }
</style>

    <div class="container">
        <div class="row">
            <div class="col">
                <div class="card" style="width: 100%">

                <div class="jb-wrap">
                    <div class="text-center jb-image">
                        <img class="img-fluid" src="{{movie.poster.url}}"  alt="...">
                    </div>

                    <div class="jb-text">
                        <p>감독 | {{ movie.director }}</p>
                        <p>장르 | {{ movie.genre }}</p>
                        <p>출연 | {{ movie.actor }}</p>
                        <p>개봉 | {{ movie.release_date }}</p>
                    </div>
                    <div class="title_text">
                        <h2>{{ movie.title }}</h2>
                    </div>
                </div>

                    <div class="card-body">
                        <div>
                            <h5 class="text-start">Synopsis</h5>
                            <hr style="height:1px;border:none;color:#333;background-color:#333;">
                            <p class="text-center" style="line-height: 2.0;">{% autoescape on %}{{movie.content|safe}}{% endautoescape %}</p>
                            <br><br>
                            <h5 class="text-start">Review</h5>
                            <hr style="height:1px;border:none;color:#333;background-color:#333;">
                        
                            <div class="container mb-5">
                                <div class="row">
                                    {% for review in reviews %}
                                    <div class="col-md-3">
                                        <div class="card text-center" style="width: 100%">
                                            <h3 class="review_title text-center mt-3">{{review.title}}</h3>
                                            <div class="card-body">
                                              <span class="stars text-dark me-2 d-flex justify-content-center">{{review.rating}}</span>
                                              <p class="mt-3">{{request.user}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="text-center">
                                <a href="{% url 'theater:chart_list' %}">
                                    <button type="button" class="btn btn-dark my-5 text-center">목록</button>
                                </a>
                            </div>

                        </div>
                    
                    
                    </div>

                    

                </div>  
            </div>
        </div>
    </div>
      
    


    <p>{{ movie.rating }}</p>
    <a class="badge rounded-pill bg-light text-dark" href="{% if movie.video %} {{movie.video.url}} {% endif %}">예고편</a>
    <h2><a href="{% url 'theater:review_enroll' pk=movie.id%}">리뷰 작성</a></h2>
    

    <p>Review</p>
    {% for review in reviews %}
        <p>{{review.title}}</p>
        <p>{{review.user}}</p>
    {% endfor %}
    

  
  
    
    <a href="">전체 보기(리뷰)</a>
    <a href="{% url 'theater:chart_list' %}">목록</a>


<script>
const rating = document.querySelectorAll(".stars");
rating.forEach((value) => {
  let ratingStars = "";
  for (let i = 0; i < Math.floor(value.innerText); i++) {
    ratingStars += '<i class="fas fa-star"></i>';
  }
  if (value.innerText % 1) {
    ratingStars += '<i class="fas fa-star-half"></i>';
  }
  value.innerHTML = ratingStars;
});

</script>





{% endblock %}